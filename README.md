# HighResolutionBot
Телеграм бот, который улучшает качество фотографий

Бот: @HighResolution_bot
Сейчас бот не работает из-за приостановки его работы на сервере 

# 1. Выбор нейросети для бота
Изначально я хотела создать полезоного и удобного бота для улучшения качества отпраляемых ему сообщений, потому начала искать соответствубщие GAN. Первым мне попался ESRGAN от xinntao[1], но результаты её работы показались мне недостаточно хорошими, потому я выбрала улученную версию этой сети от того же создателя - Real-ESRGAN. При прикручивании именно этой версии возникли непреодолимые тредности, поэтому, порывшись в GitHub, я нашла более удобный репозиторий, созданный ai-forever[2].
На обучение настолько же хорошей сети у меня не было ни технических ресурсов, ни времени, поэтому я остановилась на Real-ESRGAN
[1]https://github.com/xinntao/ESRGAN
[2]https://github.com/ai-forever/Real-ESRGAN

# 2. Телеграм бот
@BotFather помог создать бота; библиотека, сделавшая его работатспособным - aiogram.
Все-все зависимости лежат в requirements.txt, токен - в файле .env

Как всё работает:
1. Сначала с ботом надо поздороваться комнадой /start
2. Далее он попросит отправить ему фото, документ в формате .png, .jpg или **неанимированный** стикер. Если ему что-то не понрмавится, он об этом сообщит.  
3. Если функционал бота кажется неочевидным, команда /help во всплывающей клавиатуре расскажет что да как 
4. В случае, когда бот долго обрабатывает фотографию, то есть более 10 минут, прервать его работу можно либо командой /restart, либо /upscale_image
5. Бот асинхронный, потому сразу несколько пользователей могут с ним общаться)

 PS: с асинхронностью пришлось помучаться, потому что функция, обраатывающая фото была блокирующей, но это решилось парочкой async и await


 ## 3. Докер
Создание докер-образа и его последующее размещение на сервере реализовано на ПО Docker. Давайте поближе посмотрим на процесс развёртывания сервера:

1. Сначала скачиваем Docker Desktop для вашей операционной системы. **Начиная с пункта 3**, приложение **должно** быть запущено. 
2. Для проекта пишем 2 файла: с зависимостями вашего бота - requirements.txt, и непосредственно сам Dockerfile со всеми необходимыми командами
3. В консоли переходим в директорию, где находится ваш проект и Dockerfile. Затем пишем следующую команду:  
**docker build -t your_image_name .**  
После ввода команды начнётся процесс сборки docker-образа. После завершения сборки вы сможете протестировать работу образа, запустив его при помощи команды:  
**docker run your_image_name**  


## 4. Тесты
Их пока нет)


## 5. Ограничения и тонкости
1. Нейронка RealESRGAN обучалась на заблюренных или низкокачественных фото, так что чего-то экстроординарного от обработки 2k фото ждать не стоит. 4k так де не стоит заливать, так как просто нехватит вычислительных ресурсов, бот об этом не скажет и в вашем с ним чате будет сохраняться многозначительное молчание, пока у вас не лопнет терпение
2. Наибольшую боль доставил модуль самой неройнки, адекватно подключающийся при запуске с локальной системы и отказывающийся работать при упаковки проекта в Docker
3. Из-за размера двух папок из venv Lib и Scripts гит их не загрузил, поэтому проект у вас может не собраться. Проблема в процессе решения 


## 6. Деплой
В процессе


## 7. Результаты 
![image](https://github.com/AnnAnsas/HighResolutionBot/assets/106018036/1e834f9e-4ba4-499f-b6b5-0630c11a8cde)
![image](https://github.com/AnnAnsas/HighResolutionBot/assets/106018036/9837e3fe-5d6b-489b-8bc0-fdc3b2c8b06c)
![image](https://github.com/AnnAnsas/HighResolutionBot/assets/106018036/50965cff-0d0a-4187-bb47-738f9f6d93c7)




    
